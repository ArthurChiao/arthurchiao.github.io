---
layout    : post
title     : "字符集、字符编码"
date      : 2019-12-22
lastupdate: 2019-12-22
categories: unicode utf-8
---

# 1. 如何表示所有字符

## 1.1 设计字符集

要唯一地表示每一个字符，最简单的方式就是：

1. 设计一张包含所有字符的**字符表**（字符集）
1. 给其中每个字符一个唯一的**索引**
1. 使用**固定位宽**整形（例如统一使用 4 个字节）表示索引

Unicode 就是这样一种字符集。它使用 **3 个字节表示索引** [1]，索引范围 `0x0000 ~
0x10FFFF`，因此可以唯一地表示 `1,114,112`（或 `111 万 4112`）个字符，这
足够收录世界上所有的人类语言字符了。

> 字符集定义 code space，每个字符索引称为一个 code point（码点）。

字符集的例子有：

1. Unicode
1. ASCII
1. GB2312、GBK、GB18030

## 1.2 字符索引（index）与字符本身（character）

注意，上面只是说：Unicode **唯一地规定了每个字符的索引**，例如中文“天”字在
Unicode字符集中对应的索引是 `0x5929`（用 Unicode 的表示法是 `U+5929`），但是，
Unicode **并没有规定字符的显式格式**，后者留给操作系统、浏览器或渲染字符的应用自
己去实现。

这也是为什么同样一个文件
，用不同软件打开或者在不同操作系统上显式效果可能不一样的原因。

## 1.3 字体

字体定义了字符的图形表示。

## 1.4 字符编码/转换（transform/encode）

按以上分析，有了 Unicode 索引和对应的平台实现的字体，我们就可以正常使用这些字符
编写文档了，那为什么还有各种各样的字符编码方案（例如UTF-8、UTF-16、GB18030）呢？

设想一下，如果你的文档是全英文的，那使用 ASCII 就够了，每个字符只需
要 7 比特（实际存储使用一个字节）；而使用 Unicode 索引存储的话，每个字符就需要 3
个字节，存储空间和传输带宽直接增加了两倍。

因此，出于节省存储空间、提高传输效率等原因，人们提出了一些对 Unicode 索引进行变
换的方案：**将每个 Unicode 码点唯一地变换成另一个值，后者的平均长度更短**。有了
这种变换方案，实际中存储和传输的不再是原始 Unicode 码点，而是经过变换之后的值。
在需要渲染字符时，再将这些值变换回 Unicode 码点。

编码方案的另一个好处是，在设计时可以选择兼容 ASCII 格式，这样遗留下来的大量
ASCII文档不需要做任何转换就可以被处理 Unicode 的程序处理。

# 2. 字符（编码）变换方案

## 2.1 UTF-8

使用最广泛的 Unicode （码点）编码方案是 UTF-8。UTF-8 是不定长编码，使用 `1~6` 字
节对 Unicode 码点进行编码，并与 ASCII 兼容。其效果是最常用的字符所占字节较少，不
常用的字符所占字节较大，整体压缩效率比较高。

## References

1. [Wikipedia: Unicode](https://en.wikipedia.org/wiki/Unicode)
